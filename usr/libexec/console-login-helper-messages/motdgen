#!/usr/bin/bash

# Copyright (c) 2019 Fedora CoreOS Authors. All rights reserved.
# Copyright (c) 2014 The CoreOS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
# Modified from the CoreOS repository: https://github.com/coreos/init/blob/master/scripts/motdgen

# Generate a motd to display before login at startup.

set -e

. /usr/lib/console-login-helper-messages/libutil.sh
. /usr/lib/console-login-helper-messages/motdgen.defs

# Generate a motd from compiling the snippets in `/etc` and `/usr/lib`.
# The generated motd will be appended to snippets generated during runtime.
source_dirs=("${ETC_SNIPPETS}" "${USR_LIB_SNIPPETS}")

cat_via_tempfile "${STATIC_SNIPPET}" ".motd" "" "${source_dirs[@]}"
